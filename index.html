<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频播放器 - 点击名称播放</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
            min-height: calc(100vh - 40px);
        }
        
        .page-header {
            text-align: center;
            padding: 20px 0;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .status-bar {
            text-align: center;
            padding: 8px;
            background-color: rgba(0,0,0,0.3);
            color: white;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        /* 视频播放器区域 */
        .player-section {
            flex: 1;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .player-header {
            background: linear-gradient(90deg, #4a4a4a, #2c2c2c);
            color: white;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .player-header i {
            font-size: 20px;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            flex: 1;
            min-height: 500px;
            background-color: #000;
        }
        
        .video-player {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .player-controls {
            padding: 15px;
            background-color: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }
        
        .current-video-info {
            padding: 10px 15px;
            background-color: #e9ecef;
            font-weight: bold;
            color: #495057;
            border-bottom: 1px solid #dee2e6;
            word-wrap: break-word;
        }
        
        /* 视频列表区域 */
        .video-list-section {
            width: 300px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .list-header {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .list-container {
            flex: 1;
            overflow-y: auto;
            max-height: calc(100vh - 100px);
        }
        
        .video-item {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .video-item:hover {
            background-color: #f8f9fa;
            transform: translateX(5px);
        }
        
        .video-item.active {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            font-weight: bold;
        }
        
        .video-item i {
            color: #6c757d;
            min-width: 20px;
        }
        
        .video-item.active i {
            color: #2196f3;
        }
        
        .refresh-btn {
            width: 100%;
            padding: 12px;
            background-color: #28a745;
            color: white;
            border: none;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-weight: bold;
        }
        
        .refresh-btn:hover {
            background-color: #218838;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
            font-style: italic;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .video-list-section {
                width: 100%;
                max-width: 100%;
            }
        }
        
        /* 简单的图标样式 */
        .icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .icon-play {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cpolygon points='10 8 16 12 10 16 10 8'%3E%3C/polygon%3E%3C/svg%3E");
        }
        
        .icon-refresh {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M23 4v6h-6'%3E%3C/path%3E%3Cpath d='M20.49 15a9 9 0 1 1-2.12-9.36L23 10'%3E%3C/path%3E%3C/svg%3E");
        }
        
        .icon-movie {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='2' y='2' width='20' height='20' rx='2.18' ry='2.18'%3E%3C/rect%3E%3Cline x1='7' y1='2' x2='7' y2='22'%3E%3C/line%3E%3Cline x1='17' y1='2' x2='17' y2='22'%3E%3C/line%3E%3Cline x1='2' y1='12' x2='22' y2='12'%3E%3C/line%3E%3Cline x1='2' y1='7' x2='7' y2='7'%3E%3C/line%3E%3Cline x1='2' y1='17' x2='7' y2='17'%3E%3C/line%3E%3Cline x1='17' y1='17' x2='22' y2='17'%3E%3C/line%3E%3Cline x1='17' y1='7' x2='22' y2='7'%3E%3C/line%3E%3C/svg%3E");
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 视频播放器区域 -->
        <div class="player-section">
            <div class="player-header">
                <span class="icon icon-play"></span>
                视频播放器
            </div>
            <div class="current-video-info" id="current-video-name">
                请选择一个视频开始播放
            </div>
            <div class="video-container">
                <video id="video-player" class="video-player" controls></video>
            </div>
            <div class="player-controls">
                <div class="status-bar">
                    状态: <span id="status-text">等待加载地址列表...</span>
                </div>
            </div>
        </div>
        
        <!-- 视频列表区域 -->
        <div class="video-list-section">
            <div class="list-header">
                <span class="icon icon-movie"></span>
                视频列表
            </div>
            <div class="list-container" id="video-list-container">
                <div class="empty-state">正在加载视频列表...</div>
            </div>
            <button class="refresh-btn" id="refresh-btn">
                <span class="icon icon-refresh"></span>
                重新加载列表
            </button>
        </div>
    </div>

    <script>
        // 全局变量
        let videoUrls = [];
        let videoNames = [];
        let currentVideoIndex = -1;
        const videoPlayer = document.getElementById('video-player');
        const currentVideoName = document.getElementById('current-video-name');
        const statusText = document.getElementById('status-text');
        const videoListContainer = document.getElementById('video-list-container');
        const refreshBtn = document.getElementById('refresh-btn');
        
        // 配置
        const config = {
            videoUrlsFile: '1.txt',
            autoGenerateNames: true // 从URL自动生成名称
        };
        
        // 解析URL获取视频名称
        function getVideoNameFromUrl(url) {
            try {
                // 获取URL路径部分
                const path = new URL(url).pathname;
                // 获取文件名
                const filename = path.split('/').pop();
                // 移除查询参数
                return filename.split('?')[0] || '未知视频';
            } catch (e) {
                // 如果URL解析失败，返回简化版本
                return url.substring(0, 50) + (url.length > 50 ? '...' : '');
            }
        }
        
        // 加载视频地址列表
        function loadVideoUrls() {
            statusText.textContent = '正在加载地址列表...';
            videoListContainer.innerHTML = '<div class="empty-state">正在加载视频列表...</div>';
            
            fetch(config.videoUrlsFile + '?t=' + new Date().getTime()) // 添加时间戳防止缓存
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(text => {
                    // 按行分割文本，过滤空行和注释
                    const lines = text.split('\n')
                        .map(line => line.trim())
                        .filter(line => line.length > 0 && !line.startsWith('#'));
                    
                    if (lines.length === 0) {
                        videoUrls = [];
                        videoNames = [];
                        statusText.textContent = '警告：地址文件为空或格式不正确';
                        videoListContainer.innerHTML = '<div class="empty-state">没有找到视频地址</div>';
                        return;
                    }
                    
                    // 分离URL和名称（支持"名称|URL"格式）
                    videoUrls = [];
                    videoNames = [];
                    
                    lines.forEach(line => {
                        const pipeIndex = line.indexOf('|');
                        if (pipeIndex > 0) {
                            // 格式：名称|URL
                            videoNames.push(line.substring(0, pipeIndex).trim());
                            videoUrls.push(line.substring(pipeIndex + 1).trim());
                        } else {
                            // 只有URL
                            videoUrls.push(line);
                            if (config.autoGenerateNames) {
                                videoNames.push(getVideoNameFromUrl(line));
                            } else {
                                videoNames.push(`视频 ${videoNames.length + 1}`);
                            }
                        }
                    });
                    
                    statusText.textContent = `成功加载 ${videoUrls.length} 个视频`;
                    renderVideoList();
                })
                .catch(error => {
                    console.error('加载地址文件失败:', error);
                    statusText.textContent = `加载失败: ${error.message}`;
                    videoListContainer.innerHTML = `
                        <div class="empty-state">
                            加载视频列表失败！<br><br>
                            请检查：<br>
                            1. 1.txt是否在同一目录<br>
                            2. 服务器是否正常运行<br>
                            3. 浏览器控制台是否有错误
                        </div>
                    `;
                });
        }
        
        // 渲染视频列表
        function renderVideoList() {
            if (videoUrls.length === 0) {
                videoListContainer.innerHTML = '<div class="empty-state">没有视频可播放</div>';
                return;
            }
            
            let html = '';
            videoNames.forEach((name, index) => {
                html += `
                <div class="video-item ${index === currentVideoIndex ? 'active' : ''}" data-index="${index}">
                    <span class="icon icon-play"></span>
                    <span class="video-name">${name}</span>
                </div>
                `;
            });
            
            videoListContainer.innerHTML = html;
            
            // 绑定点击事件
            document.querySelectorAll('.video-item').forEach(item => {
                item.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    playVideo(index);
                });
            });
        }
        
        // 播放指定视频
        function playVideo(index) {
            if (index < 0 || index >= videoUrls.length) return;
            
            const url = videoUrls[index];
            const name = videoNames[index];
            
            // 更新当前视频信息
            currentVideoName.textContent = name;
            statusText.textContent = `正在播放: ${name}`;
            
            // 更新活动状态
            if (currentVideoIndex >= 0) {
                const prevItem = document.querySelector(`.video-item[data-index="${currentVideoIndex}"]`);
                if (prevItem) prevItem.classList.remove('active');
            }
            
            const currentItem = document.querySelector(`.video-item[data-index="${index}"]`);
            if (currentItem) currentItem.classList.add('active');
            
            // 播放视频
            videoPlayer.src = url;
            videoPlayer.play().catch(e => {
                statusText.textContent = '播放被阻止，请点击播放按钮';
                console.log('自动播放被阻止:', e);
            });
            
            currentVideoIndex = index;
        }
        
        // 重新加载列表
        refreshBtn.addEventListener('click', loadVideoUrls);
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadVideoUrls();
            
            // 监听视频播放结束事件，自动播放下一个
            videoPlayer.addEventListener('ended', function() {
                if (currentVideoIndex >= 0 && currentVideoIndex < videoUrls.length - 1) {
                    playVideo(currentVideoIndex + 1);
                }
            });
        });
    </script>
</body>
</html>
